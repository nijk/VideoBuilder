{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1a137b8de48ee0d0c0dc","webpack:///./src/VideoBuilder.js","webpack:///./src/AVIBuilder.js","webpack:///./src/BlobBuilder.js"],"names":["VideoBuilder","videoOpts","fps","width","height","encodingOpts","RateBase","undefined","AVIF_HASINDEX","movieDesc","w","h","videoStreamSize","maxJPEGSize","frameList","frameIndices","indexChunk","builder","data","next","frameDu","Math","floor","settings","console","debug","avi","createAVIStructure","headerLIST","createHeaderLIST","moviLIST","createMoviLIST","prepareData","addFrames","createStreamHeader","createAVIHeader","createAVIContainer","build","blobBuilder","appendStructure","blob","getBlob","map","frame","size","aStreams","IndexEntryOrder","streamSize","frameCount","length","frOffset","i","frsize","addVideoStreamData","push","chId","dwFlags","AVIIF_KEYFRAME","dwOffset","dwLength","_order","dwSize","list","frameBuffer","stream","createMoviStream","handler","bb","append","strh","wRight","wBottom","dwScale","bi","createBitmapHeader","dwWidth","dwHeight","dwSizeImage","strf","createStreamFormat","sContent","streamHeaderLIST","createStreamHeaderLIST","aList","avih","createAVIMainHeader","dwMicroSecPerFrame","dwMaxBytesPerSec","dwTotalFrames","dwSuggestedBufferSize","hdrlSize","aData","chFourCC","aviSize","AVIBuilder","opts","chRIFF","dwPaddingGranularity","dwInitialFrames","dwStreams","dwReserved1","dwReserved2","dwReserved3","dwReserved4","chLIST","chType","chTypeFourCC","chHandlerFourCC","wPriority","wLanguage","dwRate","dwStart","dwQuality","dwSampleSize","wLeft","wTop","wPlanes","wBitcount","chCompression","dwXPelsPerMeter","dwYPelsPerMeter","dwClrUsed","dwClrImportant","W_SOI","aSegments","W_EOI","s","od","len","fieldName","val","char","charAt","_abtempBYTE","ArrayBuffer","_u8tempBYTE","Uint8Array","abtempDWORD","u8tempDWORD","abtempWORD","u8tempWORD","dlen","j","TypeError","BlobBuilder","parts","part","type","Blob"],"mappings":"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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1a137b8de48ee0d0c0dc","'use strict';\nimport AVIBuilder from './AVIBuilder';\nimport BlobBuilder from './BlobBuilder';\n\nexport default class VideoBuilder {\n  constructor (videoOpts = {}) {\n    const {\n      fps = 30,\n      width = 0,\n      height = 0,\n    } = videoOpts;\n\n    const encodingOpts = {\n      RateBase: undefined, // @fixme\n      AVIF_HASINDEX: undefined, // @fixme\n    };\n\n    this.movieDesc = {\n      fps,\n      w: width,\n      h: height,\n      videoStreamSize: 0,\n      maxJPEGSize: 0\n    };\n\n    this.frameList = [];\n    this.frameIndices = [];\n    this.indexChunk = {};\n\n    this.builder = new AVIBuilder(encodingOpts);\n  }\n\n  generate (data, next) {\n    const frameDu = Math.floor(this.builder.settings.RateBase / this.movieDesc.fps);\n\n    console.debug('Generating AVI');\n\n    this.avi = this.builder.createAVIStructure();\n    this.headerLIST = this.builder.createHeaderLIST();\n    this.moviLIST = this.builder.createMoviLIST();\n\n    this.prepareData(data)\n      .addFrames()\n      .createStreamHeader(frameDu)\n      .createAVIHeader(frameDu)\n      .createAVIContainer()\n      .build(next);\n  }\n\n  build (next) {\n    const blobBuilder = new BlobBuilder();\n\n    this.builder.appendStructure(blobBuilder, this.avi);\n    const blob = blobBuilder.getBlob('video/avi');\n\n    return next(blob);\n  }\n\n  prepareData (data) {\n    this.frameList = data.map((frame) => {\n      /*const base64 = new Base64();\n       const blobBuilder = new BlobBuilder();\n       const dataStart = frame.indexOf(',') + 1;\n\n       let arrayBuffer, Uint8ArrayBuffer, blob;\n\n       let bytes = base64.decode(frame.substring(dataStart));\n\n       if (bytes.length % 2) { // padding\n       bytes.push(0)\n       }\n\n       arrayBuffer = new ArrayBuffer(bytes.length);\n       Uint8ArrayBuffer = new Uint8Array(arrayBuffer);\n\n       for (let i = 0; i < bytes.length; i++) {\n       Uint8ArrayBuffer[i] = bytes[i];\n       }\n\n       blobBuilder.append(arrayBuffer);\n       blob = blobBuilder.getBlob('image/jpeg');*/\n\n      this.movieDesc.videoStreamSize += frame.size;\n\n      if (this.movieDesc.maxJPEGSize < frame.size) {\n        this.movieDesc.maxJPEGSize = frame.size;\n      }\n\n      return frame;\n    });\n\n    return this;\n  }\n\n  addFrames () {\n    this.moviLIST.aStreams = []; // @fixme: could this move to the constructor?\n\n    const IndexEntryOrder = ['chId', 'dwFlags', 'dwOffset', 'dwLength']; // @fixme: Is this a setting/constant?\n\n    let streamSize = 0;\n    let frameCount = this.frameList.length;\n    let frOffset = 4; // 'movi' +0\n\n    for (let i = 0; i < frameCount; i++) {\n      let frsize = this.addVideoStreamData(this.moviLIST.aStreams, this.frameList[i]);\n      this.frameIndices.push({\n        chId: '00dc',\n        dwFlags: this.builder.settings.AVIIF_KEYFRAME,\n        dwOffset: frOffset,\n        dwLength: frsize - 8,\n        _order: IndexEntryOrder,\n      });\n\n      frOffset += frsize;\n      streamSize += frsize;\n    }\n\n    this.moviLIST.dwSize = streamSize + 4; // + 'movi'\n\n    return this;\n  }\n\n  addVideoStreamData (list, frameBuffer) {\n    let stream = this.builder.createMoviStream();\n\n    stream.dwSize = frameBuffer.size;\n    stream.handler = (bb) => bb.append(frameBuffer);\n    list.push(stream);\n\n    return stream.dwSize + 8;\n  }\n\n  createStreamHeader (frameDu) {\n    let strh = this.builder.createStreamHeader();\n    strh.wRight = this.movieDesc.w;\n    strh.wBottom = this.movieDesc.h;\n    strh.dwLength = this.frameList.length;\n    strh.dwScale = frameDu;\n\n    let bi = this.builder.createBitmapHeader();\n    bi.dwWidth = this.movieDesc.w;\n    bi.dwHeight = this.movieDesc.h;\n    bi.dwSizeImage = 3 * bi.dwWidth * bi.dwHeight;\n\n    let strf = this.builder.createStreamFormat();\n    strf.dwSize = bi.dwSize;\n    strf.sContent = bi;\n\n    this.streamHeaderLIST = this.builder.createStreamHeaderLIST();\n    this.streamHeaderLIST.dwSize = 4 + (strh.dwSize + 8) + (strf.dwSize + 8);\n    this.streamHeaderLIST.aList = [strh, strf];\n\n    return this;\n  }\n\n  createAVIHeader (frameDu) {\n    let avih = this.builder.createAVIMainHeader();\n    avih.dwMicroSecPerFrame = frameDu;\n    avih.dwMaxBytesPerSec = this.movieDesc.maxJPEGSize * this.movieDesc.fps;\n    avih.dwTotalFrames = this.frameList.length;\n    avih.dwWidth = this.movieDesc.w;\n    avih.dwHeight = this.movieDesc.h;\n    avih.dwSuggestedBufferSize = 0;\n\n    let hdrlSize = 4;\n    hdrlSize += avih.dwSize + 8;\n    hdrlSize += this.streamHeaderLIST.dwSize + 8;\n    this.headerLIST.dwSize = hdrlSize;\n    this.headerLIST.aData = [avih, this.streamHeaderLIST];\n\n    this.indexChunk = {\n      chFourCC: 'idx1',\n      dwSize: this.frameIndices.length * 16,\n      aData: this.frameIndices,\n      _order: ['chFourCC', 'dwSize', 'aData']\n    }\n\n    return this;\n  }\n\n  createAVIContainer () {\n    let aviSize = 0;\n    aviSize += 8 + this.headerLIST.dwSize;\n    aviSize += 8 + this.moviLIST.dwSize;\n    aviSize += 8 + this.indexChunk.dwSize;\n\n    this.avi.dwSize = aviSize + 4;\n    this.avi.aData = [this.headerLIST, this.moviLIST, this.indexChunk];\n\n    return this;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/VideoBuilder.js","'use strict'\r\n\r\nexport default class AVIBuilder {\r\n  constructor (opts) {\r\n    // @fixme: provide sensible defaults\r\n    const {\r\n      RateBase = 1000000,\r\n      AVIF_HASINDEX = 0x00000010,\r\n      AVIIF_KEYFRAME = 0x00000010,\r\n    } = opts || {}\r\n\r\n    this.settings = { RateBase, AVIF_HASINDEX, AVIIF_KEYFRAME };\r\n  }\r\n\r\n  createAVIStructure () {\r\n    return {\r\n      chRIFF: 'RIFF',\r\n      chFourCC: 'AVI ',\r\n      dwSize: 0,\r\n      aData: null,\r\n      _order: ['chRIFF', 'dwSize', 'chFourCC', 'aData'],\r\n    }\r\n  }\r\n\r\n  createAVIMainHeader () {\r\n    return {\r\n      chFourCC: 'avih',\r\n      dwSize: 56,\r\n      // -----\r\n      dwMicroSecPerFrame: 66666,\r\n      dwMaxBytesPerSec: 1000,\r\n      dwPaddingGranularity: 0,\r\n      dwFlags: this.settings.AVIF_HASINDEX,\r\n      // +16\r\n\r\n      dwTotalFrames: 1,\r\n      dwInitialFrames: 0,\r\n      dwStreams: 1,\r\n      dwSuggestedBufferSize: 0,\r\n      // +32\r\n\r\n      dwWidth: 10,\r\n      dwHeight: 20,\r\n      dwReserved1: 0,\r\n      dwReserved2: 0,\r\n      dwReserved3: 0,\r\n      dwReserved4: 0,\r\n      // +56\r\n\r\n      _order: [\r\n        'chFourCC', 'dwSize',\r\n        'dwMicroSecPerFrame', 'dwMaxBytesPerSec', 'dwPaddingGranularity', 'dwFlags',\r\n        'dwTotalFrames', 'dwInitialFrames', 'dwStreams', 'dwSuggestedBufferSize',\r\n        'dwWidth', 'dwHeight', 'dwReserved1', 'dwReserved2', 'dwReserved3', 'dwReserved4'\r\n      ],\r\n    }\r\n  }\r\n\r\n  createHeaderLIST () {\r\n    return {\r\n      chLIST: 'LIST',\r\n      dwSize: 0,\r\n      chFourCC: 'hdrl',\r\n      aData: null,\r\n      _order: ['chLIST', 'dwSize', 'chFourCC', 'aData'],\r\n    }\r\n  }\r\n\r\n  createMoviLIST () {\r\n    return {\r\n      chLIST: 'LIST',\r\n      dwSize: 0,\r\n      chFourCC: 'movi',\r\n      aStreams: null,\r\n      _order: ['chLIST', 'dwSize', 'chFourCC', 'aStreams'],\r\n    }\r\n  }\r\n\r\n  createMoviStream () {\r\n    return {\r\n      chType: '00dc',\r\n      dwSize: 0,\r\n      handler: null,\r\n      _order: ['chType', 'dwSize', 'handler'],\r\n    }\r\n  }\r\n\r\n  createStreamHeaderLIST () {\r\n    return {\r\n      chLIST: 'LIST',\r\n      dwSize: 0,\r\n      chFourCC: 'strl',\r\n      aList: null,\r\n      _order: ['chLIST', 'dwSize', 'chFourCC', 'aList'],\r\n    }\r\n  }\r\n\r\n  createStreamFormat () {\r\n    return {\r\n      chFourCC: 'strf',\r\n      dwSize: 0,\r\n      sContent: null,\r\n      _order: ['chFourCC', 'dwSize', 'sContent'],\r\n    }\r\n  }\r\n\r\n  createStreamHeader () {\r\n    return {\r\n      chFourCC: 'strh',\r\n      dwSize: 56,\r\n      chTypeFourCC: 'vids',\r\n      chHandlerFourCC: 'mjpg',\r\n      // +16\r\n\r\n      dwFlags: 0,\r\n      wPriority: 0,\r\n      wLanguage: 0,\r\n      dwInitialFrames: 0,\r\n      dwScale: 66666,\r\n\r\n      // +32\r\n      dwRate: this.settings.RateBase,\r\n      dwStart: 0,\r\n      dwLength: 0,\r\n      dwSuggestedBufferSize: 0,\r\n      // +48\r\n\r\n      dwQuality: 10000,\r\n      dwSampleSize: 0,\r\n      wLeft: 0,\r\n      wTop: 0,\r\n      wRight: 0,\r\n      wBottom: 0,\r\n      // +64\r\n\r\n      _order: [\r\n        'chFourCC', 'dwSize', 'chTypeFourCC', 'chHandlerFourCC',\r\n        'dwFlags', 'wPriority', 'wLanguage', 'dwInitialFrames', 'dwScale',\r\n        'dwRate', 'dwStart', 'dwLength', 'dwSuggestedBufferSize',\r\n        'dwQuality', 'dwSampleSize', 'wLeft', 'wTop', 'wRight', 'wBottom'\r\n      ],\r\n    }\r\n  }\r\n\r\n  createBitmapHeader () {\r\n    return {\r\n      dwSize: 40,\r\n      dwWidth: 10,\r\n      dwHeight: 20,\r\n      wPlanes: 1,\r\n      wBitcount: 24,\r\n      chCompression: 'MJPG',\r\n      dwSizeImage: 600,\r\n      dwXPelsPerMeter: 0,\r\n      dwYPelsPerMeter: 0,\r\n      dwClrUsed: 0,\r\n      dwClrImportant: 0,\r\n      _order: [\r\n        'dwSize', 'dwWidth', 'dwHeight', 'wPlanes', 'wBitcount', 'chCompression',\r\n        'dwSizeImage', 'dwXPelsPerMeter', 'dwYPelsPerMeter', 'dwClrUsed', 'dwClrImportant'\r\n      ]\r\n    }\r\n  }\r\n\r\n  createMJPEG () {\r\n    return {\r\n      W_SOI: 0xffd8,\r\n      aSegments: null,\r\n      W_EOI: 0xffd9,\r\n      _order: ['dwSOI', 'aSegments', 'dwEOI'],\r\n    }\r\n  }\r\n\r\n  appendStructure (bb, s) {\r\n    if (!s._order) {\r\n      throw 'Structured data must have \\'_order\\''\r\n    }\r\n\r\n    let od = s._order\r\n    let len = od.length\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      let fieldName = od[i]\r\n      let val = s[fieldName]\r\n      let char = fieldName.charAt(0)\r\n\r\n      switch (char) {\r\n        case 'b': // BYTE\r\n          let _abtempBYTE = new ArrayBuffer(1)\r\n          let _u8tempBYTE = new Uint8Array(_abtempBYTE)\r\n          _u8tempBYTE[0] = val\r\n          bb.append(_abtempBYTE)\r\n          break\r\n        case 'c': // chars\r\n          bb.append(val)\r\n          break\r\n        case 'd': // DWORD\r\n          let abtempDWORD = new ArrayBuffer(4)\r\n          let u8tempDWORD = new Uint8Array(abtempDWORD)\r\n          u8tempDWORD[0] = val & 0xff\r\n          u8tempDWORD[1] = (val >> 8) & 0xff\r\n          u8tempDWORD[2] = (val >> 16) & 0xff\r\n          u8tempDWORD[3] = (val >> 24) & 0xff\r\n          bb.append(abtempDWORD)\r\n          break\r\n        case 'w': // WORD\r\n        case 'W': // WORD(BE)\r\n          let abtempWORD = new ArrayBuffer(2)\r\n          let u8tempWORD = new Uint8Array(abtempWORD)\r\n          if (char === 'w') {\r\n            u8tempWORD[0] = val & 0xff\r\n            u8tempWORD[1] = (val >> 8) & 0xff\r\n          } else {\r\n            u8tempWORD[0] = (val >> 8) & 0xff\r\n            u8tempWORD[1] = val & 0xff\r\n          }\r\n          bb.append(abtempWORD)\r\n          break\r\n        case 'a': // Array of structured data\r\n          let dlen = val.length\r\n          for (let j = 0; j < dlen; j++) {\r\n            this.appendStructure(bb, val[j])\r\n          }\r\n          break\r\n        case 'r': // Raw(ArrayBuffer)\r\n          bb.append(val)\r\n          break\r\n        case 's': // Structured data\r\n          this.appendStructure(bb, val)\r\n          break\r\n        case 'h': // Handler function\r\n          val(bb)\r\n          break\r\n        default:\r\n          throw new TypeError(`Unknown data type: ${fieldName}`)\r\n          break\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/AVIBuilder.js","'use strict';\n\nexport default class BlobBuilder {\n  constructor () {\n    this.parts = [];\n  }\n\n  append (part) {\n    this.parts.push(part);\n    this.blob = undefined; // Invalidate the blob\n  }\n\n  getBlob (type) {\n    if (!this.blob) {\n      this.blob = new Blob(this.parts, { type: type });\n    }\n\n    return this.blob;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/BlobBuilder.js"],"sourceRoot":""}