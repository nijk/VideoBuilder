{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///main.js","webpack:///webpack/bootstrap 92d33f5d30ed012efaf2","webpack:///./src/VideoBuilder.js","webpack:///./src/AVIBuilder.js","webpack:///./src/BlobBuilder.js"],"names":["root","factory","exports","module","define","amd","a","i","this","modules","__webpack_require__","moduleId","installedModules","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","_AVIBuilder","_AVIBuilder2","_BlobBuilder","_BlobBuilder2","VideoBuilder","videoOpts","arguments","win","window","_videoOpts$fps","fps","_videoOpts$width","width","_videoOpts$height","height","_videoOpts$name","movieName","reset","avi","headerLIST","moviLIST","frameList","frameIndices","indexChunk","movieDesc","w","h","videoStreamSize","maxJPEGSize","builder","data","next","frameDu","Math","floor","settings","RateBase","createAVIStructure","createHeaderLIST","createMoviLIST","prepareData","addFrames","createStreamHeader","createAVIHeader","createAVIContainer","build","blobBuilder","appendStructure","blob","getBlob","download","ext","indexOf","substr","fileExt","filename","navigator","msSaveOrOpenBlob","downloadLink","document","createElement","href","URL","createObjectURL","body","appendChild","click","removeChild","_this","map","frame","size","aStreams","IndexEntryOrder","streamSize","frameCount","frOffset","frsize","addVideoStreamData","push","chId","dwFlags","AVIIF_KEYFRAME","dwOffset","dwLength","_order","dwSize","list","frameBuffer","stream","createMoviStream","handler","bb","append","strh","wRight","wBottom","dwScale","bi","createBitmapHeader","dwWidth","dwHeight","dwSizeImage","strf","createStreamFormat","sContent","streamHeaderLIST","createStreamHeaderLIST","aList","avih","createAVIMainHeader","dwMicroSecPerFrame","dwMaxBytesPerSec","dwTotalFrames","dwSuggestedBufferSize","hdrlSize","aData","chFourCC","aviSize","AVIBuilder","opts","_ref","_ref$RateBase","_ref$AVIF_HASINDEX","AVIF_HASINDEX","_ref$AVIIF_KEYFRAME","chRIFF","dwPaddingGranularity","dwInitialFrames","dwStreams","dwReserved1","dwReserved2","dwReserved3","dwReserved4","chLIST","chType","chTypeFourCC","chHandlerFourCC","wPriority","wLanguage","dwRate","dwStart","dwQuality","dwSampleSize","wLeft","wTop","wPlanes","wBitcount","chCompression","dwXPelsPerMeter","dwYPelsPerMeter","dwClrUsed","dwClrImportant","W_SOI","aSegments","W_EOI","od","len","fieldName","val","char","charAt","_abtempBYTE","ArrayBuffer","Uint8Array","abtempDWORD","u8tempDWORD","abtempWORD","u8tempWORD","dlen","j","BlobBuilder","parts","part","type","Blob"],"mappings":"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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _AVIBuilder = __webpack_require__(1);\n\nvar _AVIBuilder2 = _interopRequireDefault(_AVIBuilder);\n\nvar _BlobBuilder = __webpack_require__(2);\n\nvar _BlobBuilder2 = _interopRequireDefault(_BlobBuilder);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VideoBuilder = function () {\n  function VideoBuilder() {\n    var videoOpts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var win = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n\n    _classCallCheck(this, VideoBuilder);\n\n    var _videoOpts$fps = videoOpts.fps,\n        fps = _videoOpts$fps === undefined ? 30 : _videoOpts$fps,\n        _videoOpts$width = videoOpts.width,\n        width = _videoOpts$width === undefined ? 0 : _videoOpts$width,\n        _videoOpts$height = videoOpts.height,\n        height = _videoOpts$height === undefined ? 0 : _videoOpts$height,\n        _videoOpts$name = videoOpts.name,\n        name = _videoOpts$name === undefined ? 'download' : _videoOpts$name;\n\n\n    this.window = win;\n    this.movieName = name;\n    this.fps = fps;\n    this.width = width;\n    this.height = height;\n\n    this.reset();\n  }\n\n  _createClass(VideoBuilder, [{\n    key: 'reset',\n    value: function reset() {\n      this.avi = null;\n      this.headerLIST = null;\n      this.moviLIST = null;\n      this.frameList = [];\n      this.frameIndices = [];\n      this.indexChunk = {};\n\n      this.movieDesc = {\n        fps: this.fps,\n        w: this.width,\n        h: this.height,\n        videoStreamSize: 0,\n        maxJPEGSize: 0\n      };\n\n      this.builder = new _AVIBuilder2.default();\n    }\n  }, {\n    key: 'generate',\n    value: function generate(data, next) {\n      var frameDu = Math.floor(this.builder.settings.RateBase / this.movieDesc.fps);\n\n      this.avi = this.builder.createAVIStructure();\n      this.headerLIST = this.builder.createHeaderLIST();\n      this.moviLIST = this.builder.createMoviLIST();\n\n      this.prepareData(data).addFrames().createStreamHeader(frameDu).createAVIHeader(frameDu).createAVIContainer().build(next);\n    }\n  }, {\n    key: 'build',\n    value: function build(next) {\n      var blobBuilder = new _BlobBuilder2.default();\n\n      this.builder.appendStructure(blobBuilder, this.avi);\n      var blob = blobBuilder.getBlob('video/avi');\n\n      return next ? next(blob) : this.download(blob, this.movieName, '.avi');\n    }\n  }, {\n    key: 'download',\n    value: function download(blob) {\n      var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'unnamed';\n      var ext = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n\n      ext = !ext.indexOf('.') ? ext.substr(1) : ext;\n      var fileExt = ext ? '.' + ext : '';\n      var filename = '' + name + fileExt;\n\n      if (this.window.navigator.msSaveOrOpenBlob) {\n        this.window.navigator.msSaveOrOpenBlob(blob, filename);\n      } else {\n        var downloadLink = this.window.document.createElement(\"a\");\n        downloadLink.href = this.window.URL.createObjectURL(blob);\n        downloadLink.download = filename;\n        document.body.appendChild(downloadLink);\n        downloadLink.click();\n        document.body.removeChild(downloadLink);\n      }\n    }\n  }, {\n    key: 'prepareData',\n    value: function prepareData() {\n      var _this = this;\n\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      this.frameList = data.map(function (frame) {\n        _this.movieDesc.videoStreamSize += frame.size;\n\n        if (_this.movieDesc.maxJPEGSize < frame.size) {\n          _this.movieDesc.maxJPEGSize = frame.size;\n        }\n\n        return frame;\n      });\n\n      return this;\n    }\n  }, {\n    key: 'addFrames',\n    value: function addFrames() {\n      this.moviLIST.aStreams = [];\n\n      var IndexEntryOrder = ['chId', 'dwFlags', 'dwOffset', 'dwLength']; // @fixme: Is this a setting/constant?\n\n      var streamSize = 0;\n      var frameCount = this.frameList.length;\n      var frOffset = 4; // 'movi' +0\n\n      for (var i = 0; i < frameCount; i++) {\n        var frsize = this.addVideoStreamData(this.moviLIST.aStreams, this.frameList[i]);\n        this.frameIndices.push({\n          chId: '00dc',\n          dwFlags: this.builder.settings.AVIIF_KEYFRAME,\n          dwOffset: frOffset,\n          dwLength: frsize - 8,\n          _order: IndexEntryOrder\n        });\n\n        frOffset += frsize;\n        streamSize += frsize;\n      }\n\n      this.moviLIST.dwSize = streamSize + 4; // + 'movi'\n\n      return this;\n    }\n  }, {\n    key: 'addVideoStreamData',\n    value: function addVideoStreamData(list, frameBuffer) {\n      var stream = this.builder.createMoviStream();\n\n      stream.dwSize = frameBuffer.size;\n      stream.handler = function (bb) {\n        return bb.append(frameBuffer);\n      };\n      list.push(stream);\n\n      return stream.dwSize + 8;\n    }\n  }, {\n    key: 'createStreamHeader',\n    value: function createStreamHeader(frameDu) {\n      var strh = this.builder.createStreamHeader();\n      strh.wRight = this.movieDesc.w;\n      strh.wBottom = this.movieDesc.h;\n      strh.dwLength = this.frameList.length;\n      strh.dwScale = frameDu;\n\n      var bi = this.builder.createBitmapHeader();\n      bi.dwWidth = this.movieDesc.w;\n      bi.dwHeight = this.movieDesc.h;\n      bi.dwSizeImage = 3 * bi.dwWidth * bi.dwHeight;\n\n      var strf = this.builder.createStreamFormat();\n      strf.dwSize = bi.dwSize;\n      strf.sContent = bi;\n\n      this.streamHeaderLIST = this.builder.createStreamHeaderLIST();\n      this.streamHeaderLIST.dwSize = 4 + (strh.dwSize + 8) + (strf.dwSize + 8);\n      this.streamHeaderLIST.aList = [strh, strf];\n\n      return this;\n    }\n  }, {\n    key: 'createAVIHeader',\n    value: function createAVIHeader(frameDu) {\n      var avih = this.builder.createAVIMainHeader();\n      avih.dwMicroSecPerFrame = frameDu;\n      avih.dwMaxBytesPerSec = this.movieDesc.maxJPEGSize * this.movieDesc.fps;\n      avih.dwTotalFrames = this.frameList.length;\n      avih.dwWidth = this.movieDesc.w;\n      avih.dwHeight = this.movieDesc.h;\n      avih.dwSuggestedBufferSize = 0;\n\n      var hdrlSize = 4;\n      hdrlSize += avih.dwSize + 8;\n      hdrlSize += this.streamHeaderLIST.dwSize + 8;\n      this.headerLIST.dwSize = hdrlSize;\n      this.headerLIST.aData = [avih, this.streamHeaderLIST];\n\n      this.indexChunk = {\n        chFourCC: 'idx1',\n        dwSize: this.frameIndices.length * 16,\n        aData: this.frameIndices,\n        _order: ['chFourCC', 'dwSize', 'aData']\n      };\n\n      return this;\n    }\n  }, {\n    key: 'createAVIContainer',\n    value: function createAVIContainer() {\n      var aviSize = 0;\n      aviSize += 8 + this.headerLIST.dwSize;\n      aviSize += 8 + this.moviLIST.dwSize;\n      aviSize += 8 + this.indexChunk.dwSize;\n\n      this.avi.dwSize = aviSize + 4;\n      this.avi.aData = [this.headerLIST, this.moviLIST, this.indexChunk];\n\n      return this;\n    }\n  }]);\n\n  return VideoBuilder;\n}();\n\nexports.default = VideoBuilder;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AVIBuilder = function () {\n  function AVIBuilder(opts) {\n    _classCallCheck(this, AVIBuilder);\n\n    // @fixme: provide sensible defaults\n    var _ref = opts || {},\n        _ref$RateBase = _ref.RateBase,\n        RateBase = _ref$RateBase === undefined ? 1000000 : _ref$RateBase,\n        _ref$AVIF_HASINDEX = _ref.AVIF_HASINDEX,\n        AVIF_HASINDEX = _ref$AVIF_HASINDEX === undefined ? 0x00000010 : _ref$AVIF_HASINDEX,\n        _ref$AVIIF_KEYFRAME = _ref.AVIIF_KEYFRAME,\n        AVIIF_KEYFRAME = _ref$AVIIF_KEYFRAME === undefined ? 0x00000010 : _ref$AVIIF_KEYFRAME;\n\n    this.settings = { RateBase: RateBase, AVIF_HASINDEX: AVIF_HASINDEX, AVIIF_KEYFRAME: AVIIF_KEYFRAME };\n  }\n\n  _createClass(AVIBuilder, [{\n    key: 'createAVIStructure',\n    value: function createAVIStructure() {\n      return {\n        chRIFF: 'RIFF',\n        chFourCC: 'AVI ',\n        dwSize: 0,\n        aData: null,\n        _order: ['chRIFF', 'dwSize', 'chFourCC', 'aData']\n      };\n    }\n  }, {\n    key: 'createAVIMainHeader',\n    value: function createAVIMainHeader() {\n      return {\n        chFourCC: 'avih',\n        dwSize: 56,\n        // -----\n        dwMicroSecPerFrame: 66666,\n        dwMaxBytesPerSec: 1000,\n        dwPaddingGranularity: 0,\n        dwFlags: this.settings.AVIF_HASINDEX,\n        // +16\n\n        dwTotalFrames: 1,\n        dwInitialFrames: 0,\n        dwStreams: 1,\n        dwSuggestedBufferSize: 0,\n        // +32\n\n        dwWidth: 10,\n        dwHeight: 20,\n        dwReserved1: 0,\n        dwReserved2: 0,\n        dwReserved3: 0,\n        dwReserved4: 0,\n        // +56\n\n        _order: ['chFourCC', 'dwSize', 'dwMicroSecPerFrame', 'dwMaxBytesPerSec', 'dwPaddingGranularity', 'dwFlags', 'dwTotalFrames', 'dwInitialFrames', 'dwStreams', 'dwSuggestedBufferSize', 'dwWidth', 'dwHeight', 'dwReserved1', 'dwReserved2', 'dwReserved3', 'dwReserved4']\n      };\n    }\n  }, {\n    key: 'createHeaderLIST',\n    value: function createHeaderLIST() {\n      return {\n        chLIST: 'LIST',\n        dwSize: 0,\n        chFourCC: 'hdrl',\n        aData: null,\n        _order: ['chLIST', 'dwSize', 'chFourCC', 'aData']\n      };\n    }\n  }, {\n    key: 'createMoviLIST',\n    value: function createMoviLIST() {\n      return {\n        chLIST: 'LIST',\n        dwSize: 0,\n        chFourCC: 'movi',\n        aStreams: null,\n        _order: ['chLIST', 'dwSize', 'chFourCC', 'aStreams']\n      };\n    }\n  }, {\n    key: 'createMoviStream',\n    value: function createMoviStream() {\n      return {\n        chType: '00dc',\n        dwSize: 0,\n        handler: null,\n        _order: ['chType', 'dwSize', 'handler']\n      };\n    }\n  }, {\n    key: 'createStreamHeaderLIST',\n    value: function createStreamHeaderLIST() {\n      return {\n        chLIST: 'LIST',\n        dwSize: 0,\n        chFourCC: 'strl',\n        aList: null,\n        _order: ['chLIST', 'dwSize', 'chFourCC', 'aList']\n      };\n    }\n  }, {\n    key: 'createStreamFormat',\n    value: function createStreamFormat() {\n      return {\n        chFourCC: 'strf',\n        dwSize: 0,\n        sContent: null,\n        _order: ['chFourCC', 'dwSize', 'sContent']\n      };\n    }\n  }, {\n    key: 'createStreamHeader',\n    value: function createStreamHeader() {\n      return {\n        chFourCC: 'strh',\n        dwSize: 56,\n        chTypeFourCC: 'vids',\n        chHandlerFourCC: 'mjpg',\n        // +16\n\n        dwFlags: 0,\n        wPriority: 0,\n        wLanguage: 0,\n        dwInitialFrames: 0,\n        dwScale: 66666,\n\n        // +32\n        dwRate: this.settings.RateBase,\n        dwStart: 0,\n        dwLength: 0,\n        dwSuggestedBufferSize: 0,\n        // +48\n\n        dwQuality: 10000,\n        dwSampleSize: 0,\n        wLeft: 0,\n        wTop: 0,\n        wRight: 0,\n        wBottom: 0,\n        // +64\n\n        _order: ['chFourCC', 'dwSize', 'chTypeFourCC', 'chHandlerFourCC', 'dwFlags', 'wPriority', 'wLanguage', 'dwInitialFrames', 'dwScale', 'dwRate', 'dwStart', 'dwLength', 'dwSuggestedBufferSize', 'dwQuality', 'dwSampleSize', 'wLeft', 'wTop', 'wRight', 'wBottom']\n      };\n    }\n  }, {\n    key: 'createBitmapHeader',\n    value: function createBitmapHeader() {\n      return {\n        dwSize: 40,\n        dwWidth: 10,\n        dwHeight: 20,\n        wPlanes: 1,\n        wBitcount: 24,\n        chCompression: 'MJPG',\n        dwSizeImage: 600,\n        dwXPelsPerMeter: 0,\n        dwYPelsPerMeter: 0,\n        dwClrUsed: 0,\n        dwClrImportant: 0,\n        _order: ['dwSize', 'dwWidth', 'dwHeight', 'wPlanes', 'wBitcount', 'chCompression', 'dwSizeImage', 'dwXPelsPerMeter', 'dwYPelsPerMeter', 'dwClrUsed', 'dwClrImportant']\n      };\n    }\n  }, {\n    key: 'createMJPEG',\n    value: function createMJPEG() {\n      return {\n        W_SOI: 0xffd8,\n        aSegments: null,\n        W_EOI: 0xffd9,\n        _order: ['dwSOI', 'aSegments', 'dwEOI']\n      };\n    }\n  }, {\n    key: 'appendStructure',\n    value: function appendStructure(bb, s) {\n      if (!s._order) {\n        throw 'Structured data must have \\'_order\\'';\n      }\n\n      var od = s._order;\n      var len = od.length;\n\n      for (var i = 0; i < len; i++) {\n        var fieldName = od[i];\n        var val = s[fieldName];\n        var char = fieldName.charAt(0);\n\n        switch (char) {\n          case 'b':\n            // BYTE\n            var _abtempBYTE = new ArrayBuffer(1);\n            var _u8tempBYTE = new Uint8Array(_abtempBYTE);\n            _u8tempBYTE[0] = val;\n            bb.append(_abtempBYTE);\n            break;\n          case 'c':\n            // chars\n            bb.append(val);\n            break;\n          case 'd':\n            // DWORD\n            var abtempDWORD = new ArrayBuffer(4);\n            var u8tempDWORD = new Uint8Array(abtempDWORD);\n            u8tempDWORD[0] = val & 0xff;\n            u8tempDWORD[1] = val >> 8 & 0xff;\n            u8tempDWORD[2] = val >> 16 & 0xff;\n            u8tempDWORD[3] = val >> 24 & 0xff;\n            bb.append(abtempDWORD);\n            break;\n          case 'w': // WORD\n          case 'W':\n            // WORD(BE)\n            var abtempWORD = new ArrayBuffer(2);\n            var u8tempWORD = new Uint8Array(abtempWORD);\n            if (char === 'w') {\n              u8tempWORD[0] = val & 0xff;\n              u8tempWORD[1] = val >> 8 & 0xff;\n            } else {\n              u8tempWORD[0] = val >> 8 & 0xff;\n              u8tempWORD[1] = val & 0xff;\n            }\n            bb.append(abtempWORD);\n            break;\n          case 'a':\n            // Array of structured data\n            var dlen = val.length;\n            for (var j = 0; j < dlen; j++) {\n              this.appendStructure(bb, val[j]);\n            }\n            break;\n          case 'r':\n            // Raw(ArrayBuffer)\n            bb.append(val);\n            break;\n          case 's':\n            // Structured data\n            this.appendStructure(bb, val);\n            break;\n          case 'h':\n            // Handler function\n            val(bb);\n            break;\n          default:\n            throw new TypeError('Unknown data type: ' + fieldName);\n            break;\n        }\n      }\n    }\n  }]);\n\n  return AVIBuilder;\n}();\n\nexports.default = AVIBuilder;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar BlobBuilder = function () {\n  function BlobBuilder() {\n    _classCallCheck(this, BlobBuilder);\n\n    this.parts = [];\n  }\n\n  _createClass(BlobBuilder, [{\n    key: 'append',\n    value: function append(part) {\n      this.parts.push(part);\n      this.blob = undefined; // Invalidate the blob\n    }\n  }, {\n    key: 'getBlob',\n    value: function getBlob(type) {\n      if (!this.blob) {\n        this.blob = new Blob(this.parts, { type: type });\n      }\n\n      return this.blob;\n    }\n  }]);\n\n  return BlobBuilder;\n}();\n\nexports.default = BlobBuilder;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(0);\n\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// main.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 92d33f5d30ed012efaf2","'use strict';\nimport AVIBuilder from './AVIBuilder';\nimport BlobBuilder from './BlobBuilder';\n\nexport default class VideoBuilder {\n  constructor (videoOpts = {}, win = window) {\n    const {\n      fps = 30,\n      width = 0,\n      height = 0,\n      name = 'download',\n    } = videoOpts;\n\n    this.window = win;\n    this.movieName = name;\n    this.fps = fps;\n    this.width = width;\n    this.height = height;\n\n    this.reset();\n  }\n\n  reset () {\n    this.avi = null;\n    this.headerLIST = null;\n    this.moviLIST = null;\n    this.frameList = [];\n    this.frameIndices = [];\n    this.indexChunk = {};\n\n    this.movieDesc = {\n      fps: this.fps,\n      w: this.width,\n      h: this.height,\n      videoStreamSize: 0,\n      maxJPEGSize: 0\n    };\n\n    this.builder = new AVIBuilder();\n  }\n\n  generate (data, next) {\n    const frameDu = Math.floor(this.builder.settings.RateBase / this.movieDesc.fps);\n\n    this.avi = this.builder.createAVIStructure();\n    this.headerLIST = this.builder.createHeaderLIST();\n    this.moviLIST = this.builder.createMoviLIST();\n\n    this.prepareData(data)\n      .addFrames()\n      .createStreamHeader(frameDu)\n      .createAVIHeader(frameDu)\n      .createAVIContainer()\n      .build(next);\n  }\n\n  build (next) {\n    const blobBuilder = new BlobBuilder();\n\n    this.builder.appendStructure(blobBuilder, this.avi);\n    const blob = blobBuilder.getBlob('video/avi');\n\n    return next ? next(blob) : this.download(blob, this.movieName, '.avi');\n  }\n\n  download (blob, name = 'unnamed', ext = '') {\n    ext = !ext.indexOf('.') ? ext.substr(1) : ext;\n    const fileExt = ext ? `.${ext}` : '';\n    const filename = `${name}${fileExt}`;\n\n    if (this.window.navigator.msSaveOrOpenBlob) {\n      this.window.navigator.msSaveOrOpenBlob(blob, filename);\n    } else {\n      let downloadLink = this.window.document.createElement(\"a\");\n      downloadLink.href = this.window.URL.createObjectURL(blob);\n      downloadLink.download = filename;\n      document.body.appendChild(downloadLink);\n      downloadLink.click();\n      document.body.removeChild(downloadLink);\n    }\n  }\n\n  prepareData (data = []) {\n    this.frameList = data.map(frame => {\n      this.movieDesc.videoStreamSize += frame.size;\n\n      if (this.movieDesc.maxJPEGSize < frame.size) {\n        this.movieDesc.maxJPEGSize = frame.size;\n      }\n\n      return frame;\n    });\n\n    return this;\n  }\n\n  addFrames () {\n    this.moviLIST.aStreams = [];\n\n    const IndexEntryOrder = ['chId', 'dwFlags', 'dwOffset', 'dwLength']; // @fixme: Is this a setting/constant?\n\n    let streamSize = 0;\n    let frameCount = this.frameList.length;\n    let frOffset = 4; // 'movi' +0\n\n    for (let i = 0; i < frameCount; i++) {\n      let frsize = this.addVideoStreamData(this.moviLIST.aStreams, this.frameList[i]);\n      this.frameIndices.push({\n        chId: '00dc',\n        dwFlags: this.builder.settings.AVIIF_KEYFRAME,\n        dwOffset: frOffset,\n        dwLength: frsize - 8,\n        _order: IndexEntryOrder,\n      });\n\n      frOffset += frsize;\n      streamSize += frsize;\n    }\n\n    this.moviLIST.dwSize = streamSize + 4; // + 'movi'\n\n    return this;\n  }\n\n  addVideoStreamData (list, frameBuffer) {\n    let stream = this.builder.createMoviStream();\n\n    stream.dwSize = frameBuffer.size;\n    stream.handler = (bb) => bb.append(frameBuffer);\n    list.push(stream);\n\n    return stream.dwSize + 8;\n  }\n\n  createStreamHeader (frameDu) {\n    let strh = this.builder.createStreamHeader();\n    strh.wRight = this.movieDesc.w;\n    strh.wBottom = this.movieDesc.h;\n    strh.dwLength = this.frameList.length;\n    strh.dwScale = frameDu;\n\n    let bi = this.builder.createBitmapHeader();\n    bi.dwWidth = this.movieDesc.w;\n    bi.dwHeight = this.movieDesc.h;\n    bi.dwSizeImage = 3 * bi.dwWidth * bi.dwHeight;\n\n    let strf = this.builder.createStreamFormat();\n    strf.dwSize = bi.dwSize;\n    strf.sContent = bi;\n\n    this.streamHeaderLIST = this.builder.createStreamHeaderLIST();\n    this.streamHeaderLIST.dwSize = 4 + (strh.dwSize + 8) + (strf.dwSize + 8);\n    this.streamHeaderLIST.aList = [strh, strf];\n\n    return this;\n  }\n\n  createAVIHeader (frameDu) {\n    let avih = this.builder.createAVIMainHeader();\n    avih.dwMicroSecPerFrame = frameDu;\n    avih.dwMaxBytesPerSec = this.movieDesc.maxJPEGSize * this.movieDesc.fps;\n    avih.dwTotalFrames = this.frameList.length;\n    avih.dwWidth = this.movieDesc.w;\n    avih.dwHeight = this.movieDesc.h;\n    avih.dwSuggestedBufferSize = 0;\n\n    let hdrlSize = 4;\n    hdrlSize += avih.dwSize + 8;\n    hdrlSize += this.streamHeaderLIST.dwSize + 8;\n    this.headerLIST.dwSize = hdrlSize;\n    this.headerLIST.aData = [avih, this.streamHeaderLIST];\n\n    this.indexChunk = {\n      chFourCC: 'idx1',\n      dwSize: this.frameIndices.length * 16,\n      aData: this.frameIndices,\n      _order: ['chFourCC', 'dwSize', 'aData']\n    }\n\n    return this;\n  }\n\n  createAVIContainer () {\n    let aviSize = 0;\n    aviSize += 8 + this.headerLIST.dwSize;\n    aviSize += 8 + this.moviLIST.dwSize;\n    aviSize += 8 + this.indexChunk.dwSize;\n\n    this.avi.dwSize = aviSize + 4;\n    this.avi.aData = [this.headerLIST, this.moviLIST, this.indexChunk];\n\n    return this;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/VideoBuilder.js","'use strict'\r\n\r\nexport default class AVIBuilder {\r\n  constructor (opts) {\r\n    // @fixme: provide sensible defaults\r\n    const {\r\n      RateBase = 1000000,\r\n      AVIF_HASINDEX = 0x00000010,\r\n      AVIIF_KEYFRAME = 0x00000010,\r\n    } = opts || {}\r\n\r\n    this.settings = { RateBase, AVIF_HASINDEX, AVIIF_KEYFRAME };\r\n  }\r\n\r\n  createAVIStructure () {\r\n    return {\r\n      chRIFF: 'RIFF',\r\n      chFourCC: 'AVI ',\r\n      dwSize: 0,\r\n      aData: null,\r\n      _order: ['chRIFF', 'dwSize', 'chFourCC', 'aData'],\r\n    }\r\n  }\r\n\r\n  createAVIMainHeader () {\r\n    return {\r\n      chFourCC: 'avih',\r\n      dwSize: 56,\r\n      // -----\r\n      dwMicroSecPerFrame: 66666,\r\n      dwMaxBytesPerSec: 1000,\r\n      dwPaddingGranularity: 0,\r\n      dwFlags: this.settings.AVIF_HASINDEX,\r\n      // +16\r\n\r\n      dwTotalFrames: 1,\r\n      dwInitialFrames: 0,\r\n      dwStreams: 1,\r\n      dwSuggestedBufferSize: 0,\r\n      // +32\r\n\r\n      dwWidth: 10,\r\n      dwHeight: 20,\r\n      dwReserved1: 0,\r\n      dwReserved2: 0,\r\n      dwReserved3: 0,\r\n      dwReserved4: 0,\r\n      // +56\r\n\r\n      _order: [\r\n        'chFourCC', 'dwSize',\r\n        'dwMicroSecPerFrame', 'dwMaxBytesPerSec', 'dwPaddingGranularity', 'dwFlags',\r\n        'dwTotalFrames', 'dwInitialFrames', 'dwStreams', 'dwSuggestedBufferSize',\r\n        'dwWidth', 'dwHeight', 'dwReserved1', 'dwReserved2', 'dwReserved3', 'dwReserved4'\r\n      ],\r\n    }\r\n  }\r\n\r\n  createHeaderLIST () {\r\n    return {\r\n      chLIST: 'LIST',\r\n      dwSize: 0,\r\n      chFourCC: 'hdrl',\r\n      aData: null,\r\n      _order: ['chLIST', 'dwSize', 'chFourCC', 'aData'],\r\n    }\r\n  }\r\n\r\n  createMoviLIST () {\r\n    return {\r\n      chLIST: 'LIST',\r\n      dwSize: 0,\r\n      chFourCC: 'movi',\r\n      aStreams: null,\r\n      _order: ['chLIST', 'dwSize', 'chFourCC', 'aStreams'],\r\n    }\r\n  }\r\n\r\n  createMoviStream () {\r\n    return {\r\n      chType: '00dc',\r\n      dwSize: 0,\r\n      handler: null,\r\n      _order: ['chType', 'dwSize', 'handler'],\r\n    }\r\n  }\r\n\r\n  createStreamHeaderLIST () {\r\n    return {\r\n      chLIST: 'LIST',\r\n      dwSize: 0,\r\n      chFourCC: 'strl',\r\n      aList: null,\r\n      _order: ['chLIST', 'dwSize', 'chFourCC', 'aList'],\r\n    }\r\n  }\r\n\r\n  createStreamFormat () {\r\n    return {\r\n      chFourCC: 'strf',\r\n      dwSize: 0,\r\n      sContent: null,\r\n      _order: ['chFourCC', 'dwSize', 'sContent'],\r\n    }\r\n  }\r\n\r\n  createStreamHeader () {\r\n    return {\r\n      chFourCC: 'strh',\r\n      dwSize: 56,\r\n      chTypeFourCC: 'vids',\r\n      chHandlerFourCC: 'mjpg',\r\n      // +16\r\n\r\n      dwFlags: 0,\r\n      wPriority: 0,\r\n      wLanguage: 0,\r\n      dwInitialFrames: 0,\r\n      dwScale: 66666,\r\n\r\n      // +32\r\n      dwRate: this.settings.RateBase,\r\n      dwStart: 0,\r\n      dwLength: 0,\r\n      dwSuggestedBufferSize: 0,\r\n      // +48\r\n\r\n      dwQuality: 10000,\r\n      dwSampleSize: 0,\r\n      wLeft: 0,\r\n      wTop: 0,\r\n      wRight: 0,\r\n      wBottom: 0,\r\n      // +64\r\n\r\n      _order: [\r\n        'chFourCC', 'dwSize', 'chTypeFourCC', 'chHandlerFourCC',\r\n        'dwFlags', 'wPriority', 'wLanguage', 'dwInitialFrames', 'dwScale',\r\n        'dwRate', 'dwStart', 'dwLength', 'dwSuggestedBufferSize',\r\n        'dwQuality', 'dwSampleSize', 'wLeft', 'wTop', 'wRight', 'wBottom'\r\n      ],\r\n    }\r\n  }\r\n\r\n  createBitmapHeader () {\r\n    return {\r\n      dwSize: 40,\r\n      dwWidth: 10,\r\n      dwHeight: 20,\r\n      wPlanes: 1,\r\n      wBitcount: 24,\r\n      chCompression: 'MJPG',\r\n      dwSizeImage: 600,\r\n      dwXPelsPerMeter: 0,\r\n      dwYPelsPerMeter: 0,\r\n      dwClrUsed: 0,\r\n      dwClrImportant: 0,\r\n      _order: [\r\n        'dwSize', 'dwWidth', 'dwHeight', 'wPlanes', 'wBitcount', 'chCompression',\r\n        'dwSizeImage', 'dwXPelsPerMeter', 'dwYPelsPerMeter', 'dwClrUsed', 'dwClrImportant'\r\n      ]\r\n    }\r\n  }\r\n\r\n  createMJPEG () {\r\n    return {\r\n      W_SOI: 0xffd8,\r\n      aSegments: null,\r\n      W_EOI: 0xffd9,\r\n      _order: ['dwSOI', 'aSegments', 'dwEOI'],\r\n    }\r\n  }\r\n\r\n  appendStructure (bb, s) {\r\n    if (!s._order) {\r\n      throw 'Structured data must have \\'_order\\''\r\n    }\r\n\r\n    let od = s._order\r\n    let len = od.length\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      let fieldName = od[i]\r\n      let val = s[fieldName]\r\n      let char = fieldName.charAt(0)\r\n\r\n      switch (char) {\r\n        case 'b': // BYTE\r\n          let _abtempBYTE = new ArrayBuffer(1)\r\n          let _u8tempBYTE = new Uint8Array(_abtempBYTE)\r\n          _u8tempBYTE[0] = val\r\n          bb.append(_abtempBYTE)\r\n          break\r\n        case 'c': // chars\r\n          bb.append(val)\r\n          break\r\n        case 'd': // DWORD\r\n          let abtempDWORD = new ArrayBuffer(4)\r\n          let u8tempDWORD = new Uint8Array(abtempDWORD)\r\n          u8tempDWORD[0] = val & 0xff\r\n          u8tempDWORD[1] = (val >> 8) & 0xff\r\n          u8tempDWORD[2] = (val >> 16) & 0xff\r\n          u8tempDWORD[3] = (val >> 24) & 0xff\r\n          bb.append(abtempDWORD)\r\n          break\r\n        case 'w': // WORD\r\n        case 'W': // WORD(BE)\r\n          let abtempWORD = new ArrayBuffer(2)\r\n          let u8tempWORD = new Uint8Array(abtempWORD)\r\n          if (char === 'w') {\r\n            u8tempWORD[0] = val & 0xff\r\n            u8tempWORD[1] = (val >> 8) & 0xff\r\n          } else {\r\n            u8tempWORD[0] = (val >> 8) & 0xff\r\n            u8tempWORD[1] = val & 0xff\r\n          }\r\n          bb.append(abtempWORD)\r\n          break\r\n        case 'a': // Array of structured data\r\n          let dlen = val.length\r\n          for (let j = 0; j < dlen; j++) {\r\n            this.appendStructure(bb, val[j])\r\n          }\r\n          break\r\n        case 'r': // Raw(ArrayBuffer)\r\n          bb.append(val)\r\n          break\r\n        case 's': // Structured data\r\n          this.appendStructure(bb, val)\r\n          break\r\n        case 'h': // Handler function\r\n          val(bb)\r\n          break\r\n        default:\r\n          throw new TypeError(`Unknown data type: ${fieldName}`)\r\n          break\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/AVIBuilder.js","'use strict';\n\nexport default class BlobBuilder {\n  constructor () {\n    this.parts = [];\n  }\n\n  append (part) {\n    this.parts.push(part);\n    this.blob = undefined; // Invalidate the blob\n  }\n\n  getBlob (type) {\n    if (!this.blob) {\n      this.blob = new Blob(this.parts, { type: type });\n    }\n\n    return this.blob;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/BlobBuilder.js"],"sourceRoot":""}